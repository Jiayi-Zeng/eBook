# 2.2 数据表示

我们在这一章最开始介绍过，人类世界的表示与计算机世界的表示不一样，计算机世界用二进制来表示。

人类世界有丰富多彩的表现形式。日常生活中，我们用数字、汉字、图像、声音、视频等来传递和存储各种信息，而在计算机内部所有的这些文字、图像、声音、视频等都是用数字来传递和存储的。比如在计算机中用“0,0,255”表示蓝色，用“255,0,0”表示红色，用“255,0,255”表示蓝色和红色混合而成的紫色。不光是颜色，计算机对文字的处理也是这样的。计算机内部会先把文字转换成相应的数字再做处理，这样的方式我们叫作“字符编码”。例如，“A”的编码是65，“a”的编码是97。

这就涉及到二进制在计算机内部的表示以及外部数据如何转换成二进制，下面我们分别加以介绍。


## 2.2.1 比特与字

计算机内部数据的最小单位是**位（bit）**，也就是一根电线丝一次传输的电信号状态，我们用二进制数 0 或 1 来表示。如果把 8 根电线丝并排在一起，并行传输数据，则一次可以同时传输 8 种电信号状态，即 8 位二进制数（0 或 1）。

在计算机中，把 8 位聚在一起的二进制数称为一个**字节（byte）**，即 1 字节（byte）= 8 位（bit）。字节是计算机中表示数据大小的基本单位。通常字节（byte）用大写字母 B 表示，位（bit）用小写字母 b 表示。例如：16 位二进制数就是 2 字节（2B），32 位二进制数就是 4 字节（4B）（见图2.2.1）。

 ![图 2.2.1 位和字节的关系]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图 2.2.1 位和字节的关系.png)

我们在购买计算机的时候，都会看到有关计算机性能的表示方法。例如，在表示CPU性能时，可以写成16位CPU、32位CPU、64位CPU等，这里的16、32、64指的就是CPU处理数据的能力大小、并行总线一次可以传输的二进制数位多少，一般这个数值越大，CPU的性能越好。

另外还有表示计算机内存大小的512MB、2GB等，以及表示硬盘存储容量大小的500GB、2TB等，我们还会在计算机中看到某个文件大小表示为320KB这样的形式。这里的B、KB、MB、GB、TB都是计算机中表示数据大小的计量单位，通常我们把M读作“兆”，其他几个都按英文字母发音，K（kilo）、M（mega）、G（giga）、T（tera）类似于十进制数中的计量单位千、百万、十亿、万亿。

十进制数中的十、百、千、万等都是以10n来计量的，计算机中的数据都是用二进制数表示的。计算机中的K、M、G、T都是用2n来计量的，而且它们依次增大为前一个的1024倍，即210倍（见图2.2.2）。

- 1KB=1024B=1024 字节
- 1MB=1024KB=1024×1024 字节
- 1GB=1024MB=1024×1024×1024 字节
- 1TB=1024GB=1024×1024×1024×1024 字节

![图 2.2.2计算机中表示内存大小（存储容量）的单位]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图 2.2.2 计算机中表示内存大小（存储容量）的单位.png)

## 2.2.2 整数表示

### (1) 二进制原码表示法

原码(trueform)是一种计算机中对数字的二进制定点表示方法。如图2.2.3所示，原码表示法在数值前面增加了一位符号位(即最高位为符号位)：正数该位为0，负数该位为1，其余位表示数值的大小。因此0有两种表示：0 0和10。

![图 2.2.3计算机中原码表示法]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.3计算机中原码表示法.png)

原码表示法进行运算非常复杂，特别是两个操作符号不同的时候，需要以下面的方式来运算：

- 判断两个操作数绝对值大小
- 使用绝对值大的数减去绝对值小的数
- 对于符号，以绝对值大的数为准

>  **填空题 2.2.1 计算原码**
假定机器字长是8位，则十进制数-45的二进制原码是（）
正确答案： 10101101

### (2) 二进制的补码表示法

因为原码表示法进行运算非常复杂，所以对于原码表示法提出了新的需求：

* 希望找到不同符号操作数更加简单的运算方法
* 希望找到使用正数代替负数的方法
* 希望使用加法操作代替减法操作，从而消除减法的方法

事实上，在计算机系统中，数值一律用补码(two’s complement)来表示和存储。主要原因是使用补码，可以将符号位和其它位统一处理；同时，减法也可按加法来处理。另外，两个用补码表示的数相加时，如果最高位（符号位）有进位，则进位被舍弃。另外，补码与原码的转换过程几乎是相同的。补码可以很好弥补原码的问题。

补码的定义和表示方法如图2.2.4所示：当数值大于等于0，则补码表示就是原码；当数值小于0，则补码就是原码加上一个数。我们来看几个补码的例子。

![图 2.2.4计算机中补码表示法]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.4计算机中补码表示法.png)

![图片29]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图片29.png)

>**填空题 2.2.2 计算补码**
假定机器字长是8位，则十进制数-45的二进制补码是（）
正确答案： 11010011

### (3) 二进制的反码

反码也是数值存储的一种，多应用于系统环境设置，如linux平台的目录和文件的默认权限的设置umask，就是使用反码原理。反码的目的是找出原码和补码之间的规律，消除转换过程中的减法。反码的定义如下所示。

![图 2.2.5计算机中补码的目的]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.5计算机中补码的目的.png)

![图片31]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图片31.png)

反码的例子：

![图片32]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图片32.png)

> **填空题 2.2.3 计算反码**
假定机器字长是8位，则十进制数-45的二进制反码是（）
正确答案： 11010010

### (4) 原码、补码、反码总结

![图 2.2.5计算机中原码、补码、反码关系]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.5计算机中原码、补码、反码关系.png)

按照上图中的规律求反码和补码：

![图片34]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图片34.png) 

![图 2.2.6 计算机中反码表示]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.6计算机中反码表示.png)

## 2.2.3 定点数表示

定点数是一种数字表示方法。在定点表示法中，一个数值被分为两部分：整数部分和小数部分。小数点的位置是固定的，并且在一个特定的位数上。通常，整数部分和小数部分都是用二进制形式表示的。这种表示方式被称为"定点"表示法，而使用该方法表示的数字被称为"定点数"。因此，"定"指的是固定，"点"指的是小数点，这就是定点数这个名字的由来。定点数可以表示整数和小数，但要分为以下三种情况：

1. 纯整数：例如，整数100在定点表示法中，小数点实际上在最后一位，因此小数点可以忽略不写。
2. 纯小数：例如，0.123，在定点表示法中，小数点位置固定在最高位。
3. 整数+小数：例如1.24、10.34，小数点在指定某个位置

![图2.2.7计算机中定点纯小数表示]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.7计算机中定点纯小数表示.png)

![图2.2.8计算机中定点数常规表示]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.8计算机中定点数常规表示.png)

对于纯整数和纯小数，因为小数点固定在最低位和最高位，所以用定点数表示时，只需要把整数部分、小数部分，按照十进制转二进制的规则转换即可。而对于整数+小数的情况，用定点表示时，需要约定小数点的位置。

下面我们对这三种情况分别举例介绍，并且假定以1个字节（8bit）表示。

对于纯整数100，小数点固定在最高位：$(100)_{10} = (01100100)_2 $

对于纯小数 0.875，小数点固定在最低位：$(0.875)_{10} = (0.11100000)_2$。小数部分的转换的方式是乘二取整数，如图2.2.9。

![图 2.2.9 计算机中十进制小数到二进制小数转换]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.9计算机中十进制小数到二进制小数转换.png)

对于整数+小数，我们同样需要先约定小数点的位置。假设前5位表示整数部分，后3位表示小数部分。下面举2个例子：

* $(1.5)_{10}$=$(00001100)_2$
* $(25.125)_{10}$=$(11001001)_2$

这里再总结一下这个过程：在规定好的 bit 宽度下，先约定小数点的位置，再将整数部分和小数部分分别转换为二进制表示，将两部分组合起来就是结果。

但这样其实会有一个问题，因为我们约定了前 5 位表示整数部分，后 3 位表示小数部分，此时整数部分的二进制最大值只能是 11111，即十进制的 31，小数部分的二进制最大只能表示 0.111，即十进制的 0.875。

那怎么表示更大范围的值呢？其实只要扩大bit的长度即可，例如使用2个字节，甚至4个字节。另外还有一种办法就是改变小数点位置：小数点向后移动，取值范围就会扩大，但小数部分的精度可能会越来越低，没有办法表示类似0.0000001这种高精度的值。因此，数值的表示范围和精度范围是互相矛盾的：小数点往左，精度增高，但表示范围减小；小数点往右，表示范围增大，但精度降低。

由此可以发现，定点数表示的小数不仅数值表示范围有限，精度也难以提高。为了解决这两个问题，人们提出了“浮点数”的方式表示数字，本书中不再讲解这部分内容。但是我们也发现，定点数并不影响对纯整数的表示，所以现代计算机中一般使用定点数来表示整数。

在这一小节中，我们主要讲解了在计算机中如何使用定点数表示一个数字。定点数是在计算机中表示数字的一种方式，它既可以表示整数，也可以表示小数。在固定长度的bit下，约定小数点的位置，然后把整数部分和小数部分分别转换为二进制，就是定点数的结果。受限于小数点的位置，用定点数表示小数时，数值的范围和小数精度是有限的。在现代计算机中，定点数通常用来表示整数，对于高精度的小数，通常用浮点数表示。

>  **填空题 2.2.4 计算二进制定点数**
假定小数点前后各4位，那么十进制数14.25的二进制定点数是（）
正确答案：1110.1100 

## 2.2.4 符号表示

如果计算机只存储二进制数据，那么它如何表示字符呢？计算机使用的是字符集，将字符映射为整数。早期，字符集只用8位表示。即使是现在，在字符模式（如MS-DOS）下运行时，IBM兼容微机使用的还是ASCII（读为“askey”）字符集。

ASCII是美国标准信息交换码（American Standard Code for Information Interchange）的首字母缩写。在ASCII中，每个字符都被分配了一个独一无二的7位整数。

由于ASCII只用字节中的低7位，因此最高位在不同计算机上被用于创建其专有字符集。比如，IBM兼容微机就用数值128~255来表示图形符号和希腊字符。下图中列出了在Windows控制台模式下运行时使用的ASCII码。

![图片19]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图片19.png)

ASCII字符串有一个或多个字符的序列被称为字符串（string）。更具体地说，一个ASCII字符串是保存在内存中的，包含了ASCII代码的连续字节。比如，字符串“ABC123”的数字代码是41h、42h、43h、31h、32h和33h。

>  **选择题 2.2.5 ASCII码**
>  一个ASCII码字符的ASCII码值占用一个字节中的（）
>
>  * 低7位
>  * 全部
>  * 高7位
>  * 低6位
>
>  正确答案： 低7位
## 2.2.5 位图表示

位图表示图象的方法中，图像被分成像素矩阵，也称点阵，每个像素是一个小点。像素的大小取决于分辨率。把图像分成像素之后，每一个像素被赋值为一个位模式。模式的尺寸和值取决于图像。

把图像分成像素之后，每一个像素被赋值为一个位模式。模式的尺寸和值取决于图像。

例如：对于一个仅有黑白点组成的图像（例如棋盘），一个1位模式已足够表示一个像素。0模式表示黑像素，1模式表示白像素。如果采用8位，才可以表示256种颜色信息。

位图文件的基本编码格式为BMP（bitmap的缩写）文件。BMP是一种与硬件设备无关的图像文件格式。标签图像文件（Tagged Image File Format，简写为TIFF）格式是图像专业领域使用较广泛的一种编码形式，主要用来存储照片和艺术图等对图像质量要求较高的平面图像。它也是位图文件格式的一种。图2.2.10显示了一张BMP图像的二进制表示。可以看到，虽然我们看到的图像是彩色的，但是在计算机中它就是一个二进制数值串，具有一定的编码格式，这样就方便编码和解码图像。

位图图象文件的方法中，体积太大，对计算机的存储和传输都产生很大压力。图像文件信息具有一定的规律，在保证其基本信息正确的前提下，可以适当通过一定的算法缩小图像文件的大小。为了存储和传输数据，在保留原有内容的条件下，缩小所涉及数据的大小是有益的（有时也是必须的）。这个技术称为数据压缩。数据压缩方案有两类。一类是无损压缩，一类是有损压缩。

* 无损压缩：指压缩后信息表达的质量没有下降，只是文件大小减小。
* 有损压缩：指在影响信息表达质量的前提下，为加大压缩效率，尽可能减小文件的大小。

![图 2.2.10 位图表示示例]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.10位图表示示例.png)

## 2.2.5 音频信息表示

音频编码方式也有非压缩编码和压缩编码两类，压缩编码又分为有损压缩和无损压缩两种。

基本的音频编码是PCM（PulseCodeModulation，脉冲编码调制）方式，它处理后的音频信息音质较好，但往往文件体积较大。

MP3（MPEGAudioLayer-3）是目前最为普及的音频压缩编码格式，是MPEG1的衍生编码方案。MP3可以做到12:1的压缩比并保持音质基本可接受。

图2.2.11和图2.2.12表示了音频信号的编解码过程。


![图 2.2.11 音频表示]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.11音频表示.png)

![图 2.2.12音频采样过程]( https://ebook2023.oss-cn-shanghai.aliyuncs.com/图2.2.12音频采样过程.png)