{% extends "base_page.html" %}

{% load wagtailcore_tags static wagtailmarkdown %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'highlight/styles/onedark.min.css' %}">
<style>
    pre code.hljs {
        border-radius: 0.375rem;
    }
    /* 设置 iframe 样式，确保没有边距和滚动条 */
    iframe {
        margin: 0;
        padding: 0;
        border: none;
        overflow: hidden;
    }
</style>
{% endblock %}

{% block content %}
{% with page.get_site.root_page as root %}
<div class="container-fluid container-docs">
    <!-- Sidenav -->
    <nav class="sidenav navbar navbar-vertical navbar-expand-xs navbar-light bg-white" id="sidenav-main">
        <div class="scrollbar-inner px-4">
            <!-- Navigation -->
            <div class="docs-sidebar pt-6 pt-lg-7">
                {% if root.get_children %}
                {% for book in root.get_children %}
                <h5><a href="{% pageurl page.get_parent.get_parent %}">{{ book.title }}</a></h5>
                {% for chapter in book.get_children %}
                <h6 class="mt-4"><a href="{% pageurl chapter %}">{{ chapter.title }}</a></h6>
                <ul class="nav flex-column">
                    {% for post in chapter.get_children %}
                    <li class="nav-item">
                        <a href="{% pageurl post %}" class="nav-link">{{ post.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
                {% endfor %}
                {% endfor %}
                {% endif %}


            </div>
        </div>
    </nav>
    <!-- Main content -->
    <div class="main-content row position-relative pb-5">
        <div class="col-xl-9 docs-content pb-5">
            <!-- Docs title -->
            <div class="docs-title">
                <h1>{{ page.title }}</h1>
            </div>
            <!-- Docs content -->
            {{ self.body|markdown }}
        </div>
        <!-- Document toc-->
        <div class="col-xl-3 docs-sidebar d-none d-xl-block">
            <div class="toc-sidebar pl-4 pr-4 mt-lg-8 border-left"
                style="height: -webkit-fill-available; overflow: auto;">
                <div class="scrollbar-inner">
                    <h6 class="mb-3">目录</h6>
                    <ul class="section-nav" , id="navbar">

                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endwith %}
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"
    integrity="sha512-gU7kztaQEl7SHJyraPfZLQCNnrKdaQi5ndOyt4L4UPL/FHDd/uB9Je6KDARIqwnNNE27hnqoWLBq+Kpe4iHfeQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- <script src="{% static 'highlight/highlight.js' %}"></script> -->
<script>hljs.highlightAll();</script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
      var showIframeButton = document.getElementById("showIframeButton");
      var iframe = document.querySelector(".auto-height-iframe");
    
      showIframeButton.addEventListener("click", function() {
        // 显示 iframe
        iframe.style.display = "block";
    
        iframe.addEventListener("load", function() {
            var iframeContentHeight = iframe.contentWindow.document.documentElement.scrollHeight;
            iframe.style.height = iframeContentHeight + "px";
        });

      });
    });
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
            inlineMath: [['$','$']],
            displayMath: [['$$','$$']] ,
            processEscapes: true
          },
          "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js">
    </script>
    
{% endblock %}